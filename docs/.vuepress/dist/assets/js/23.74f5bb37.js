(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{234:function(s,a,n){"use strict";n.r(a);var t=n(6),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"docker-基础知识汇总"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-基础知识汇总"}},[s._v("#")]),s._v(" docker 基础知识汇总")]),s._v(" "),n("h3",{attrs:{id:"docker-常见命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-常见命令"}},[s._v("#")]),s._v(" docker 常见命令")]),s._v(" "),n("p",[s._v("1、docker ps -a 查看当前所有 docker 容器\n2、docker run xxx 创建 xxx\n3、start 启动/停止 stop/重启 restart/删除已停止容器 rm【先停止再删除】\n4、登陆仓库 login/拉取镜像 pull/推送 push/提交镜像 commit/给指定的容器标签‘tag’\n5、查看所有本地镜像 images/删除本地镜像 rmi\n6、查看容器服务打印的日志 logs/检阅容器 inspect/进入容器 exec\n7、查看版本 version/docker 进程信息 info")]),s._v(" "),n("p",[n("code",[s._v("docker stop $(docker ps -aq)")]),s._v("停止所有容器\n"),n("code",[s._v("docker rm $(docker ps -aq)")]),s._v(" 删除所有容器")]),s._v(" "),n("h3",{attrs:{id:"示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),n("p",[n("code",[s._v("≈")]),s._v("，-it 是交互终端的意思\n使用 docker 创建 ubuntu 然后在其中执行交互命令 "),n("code",[s._v("ls -la")])]),s._v(" "),n("p",[s._v("同下面的命令：")]),s._v(" "),n("p",[s._v("-d 在后台运行\n-name 指定名称\n-e 设置环境变量\n-v 挂载一个文件")]),s._v(" "),n("p",[n("code",[s._v("docker run -it -d -name test ubuntu")])]),s._v(" "),n("p",[n("code",[s._v("docker exec -it test /bin/bash")])]),s._v(" "),n("p",[s._v("则可以进入到 test 容器的 /bin/bash 中")]),s._v(" "),n("p",[s._v("使用 exit 退出该容器")]),s._v(" "),n("p",[n("code",[s._v("docker run -p 8080:3306 mysql")])]),s._v(" "),n("p",[s._v("-p 把容器中的端口映射到外面宿主机来，这里是把容器 mysql 中的默认端口 3306 映射到宿主机的 8080 来")]),s._v(" "),n("p",[s._v("再如执行\n"),n("code",[s._v("docker run -p 8000:3306 -e MySQL_ROOT_PASSWORD=123456 -itd --name mysql-4 mysql")]),s._v("\n含义是使用 docker 运行 mysql，把镜像中的端口 3306 映射到宿主机端口 8000 上，并且在后台交互式运行，设置该镜像的名字为 mysql-4，密码是 123456")]),s._v(" "),n("p",[n("code",[s._v("docker run -it online-server:1.0 /bin/bash")]),s._v(" 进入 docker 进行交互")]),s._v(" "),n("h3",{attrs:{id:"docker-run-v"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-run-v"}},[s._v("#")]),s._v(" docker run -v")]),s._v(" "),n("p",[s._v("把宿主机上的一些文件系统挂载到容器上\n例如："),n("code",[s._v("docker run -v ~/Downloads/:/home -itd --name test1 ubuntu")])]),s._v(" "),n("h3",{attrs:{id:"指定拉取镜像的版本号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指定拉取镜像的版本号"}},[s._v("#")]),s._v(" 指定拉取镜像的版本号")]),s._v(" "),n("p",[n("code",[s._v("docker pull tomcat:8")])]),s._v(" "),n("h3",{attrs:{id:"登陆-docker-帐号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#登陆-docker-帐号"}},[s._v("#")]),s._v(" 登陆 docker 帐号")]),s._v(" "),n("p",[s._v("首先登陆网站： https://hub.docker.com\n进行注册：帐号：xiaozhumaopao；密码：axxxxx\n在命令行中登陆： "),n("code",[s._v("docker login")]),s._v("\n给已有的镜像打标："),n("code",[s._v("docker commit id xiaozhumaopao/hello:1.0")]),s._v(" "),n("strong",[s._v("容器 = 镜像 + 读写层")]),s._v("也就是容器是在镜像的基础上实例化出来的，\n使用"),n("code",[s._v("docker images")]),s._v("可以查看当前的镜像\n"),n("code",[s._v("docker rmi id")]),s._v("删除镜像"),n("br"),s._v("\n使用"),n("code",[s._v("docker push xiaozhumaopao/hello:1.0")]),s._v("到注册的 docker 平台上\n使用"),n("code",[s._v("docker pull xiaozhumaopao/hello:1.0")]),s._v("就可以拉取远端的镜像了【注意更改的阿里云镜像和官网有 10 分钟的延迟】\n如果设置了私有的镜像，就要先登陆 docker")]),s._v(" "),n("p",[n("code",[s._v("docker logs id")]),s._v("或者"),n("code",[s._v("docker logs name")]),s._v(" 使用 -f 命令 可以一直打印日志\n"),n("code",[s._v("docker inspect")]),s._v("可以查看容器的初始化信息\n"),n("code",[s._v("docker info")])]),s._v(" "),n("h3",{attrs:{id:"制作-docker-镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#制作-docker-镜像"}},[s._v("#")]),s._v(" 制作 docker 镜像")]),s._v(" "),n("p",[s._v("Dockerfile 是一个由一堆命令+参数构成的脚本，使用 docker build 即可执行脚本构建镜像，自动的去做一些事，主要用于持续集成；")]),s._v(" "),n("h4",{attrs:{id:"koa-代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#koa-代码"}},[s._v("#")]),s._v(" koa 代码")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Koa "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"koa"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Koa")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("ctx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello Koa"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h4",{attrs:{id:"dockerfile-示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-示例"}},[s._v("#")]),s._v(" DockerFile 示例")]),s._v(" "),n("div",{staticClass:"language-DockerFile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node:10")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LABEL")]),s._v(" maintainer = yulei20080106@126.com")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 app 目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把package.json,package-lok.json 或者 yarn.lock 复制到工作目录（相对路径）/app")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# COPY ["package.json","*.lock","./"]')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打包 app 源码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意：要指定工作目录的文件名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# COPY src ./src")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 .dockerignore 文件，上面两个COPY合并成一个")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ls -la /app")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用yarn安装app依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果你需要构建生产环境下的代码，使用 --prod参数")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yarn -prod --registry=https://registry.npm.taobao.org")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对外暴露的端口")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 3000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/index.js"')]),s._v("]")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("h4",{attrs:{id:"dockerignore"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerignore"}},[s._v("#")]),s._v(" .dockerignore")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node_modules\n.DS_Store\ndist\n\n.lock-wscript\n\nbuild/Release\n.dockerignore\nDockerfile\n*docker-compose*\n\nlogs\n*.log\n\n.idea\n.vscode\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("使用"),n("code",[s._v("docker build -t xiaozhumaopao/mykoa:1.0 .")]),s._v("打包；\n其中最后的 "),n("code",[s._v(".")]),s._v(" 表示使用当前目录下的 dockerfile\ndocker build 之后，使用 docker images 可以查看当前的 docker 镜像\n执行 "),n("code",[s._v("docker run -itd --name koa -p 4000:3000 xiaozhumaopao/mykoa:1.0")]),s._v("\n使用 docker ps 可以查看当前容器\n使用 "),n("code",[s._v("docker push xiaozhumaopao/mykoa:1.0")])]),s._v(" "),n("h3",{attrs:{id:"docker-compose"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" docker compose")]),s._v(" "),n("p",[s._v("1、安装")]),s._v(" "),n("p",[s._v("https://docs.docker.com/compose/install/")]),s._v(" "),n("blockquote",[n("p",[s._v("注意，mac 上安装了 docker 则自动的安装了 docker-compose")])]),s._v(" "),n("p",[s._v("执行"),n("code",[s._v("docker-compose --version")]),s._v("可以查看其版本号")]),s._v(" "),n("p",[s._v("常见示例：")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysql")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    image"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql\n    container_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("mysql\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8000:3306"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enviroment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_ROOT_PASSWORD=123456\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("在该文件目录下，使用 "),n("code",[s._v("docker-compose up -d")]),s._v("执行,相当于执行了上面的 docker xxx 然后执行的-d\n执行“docker-compose rm”删除刚刚建立的容器\n生命周期管理：\n创建： run/up\n启动： start/stop/rm/restart\n日志/检视：logs/ps")]),s._v(" "),n("h3",{attrs:{id:"项目实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目实战"}},[s._v("#")]),s._v(" 项目实战")]),s._v(" "),n("p",[s._v("使用 npm i koa 安装 koa 依赖后，创建 server 文件夹\n使用 npx vue create front 创建 vue2 的前端项目\n在 server 文件夹中，使用 docker 安装 mongo ，新建 docker-compose.yml 文件，执行"),n("code",[s._v("docker-compose up -d")]),s._v(" 启动 mongo,使用 docker ps 查看启动的服务\n安装 mongoose 操作 mongo，在 serve 文件夹下执行 npm i mongoose -S\n新建 dbconfig.js 文件\n使用"),n("code",[s._v("node src/dbconfig.js")]),s._v(" 可以测试链接的数据库是否成功")]),s._v(" "),n("p",[s._v("开发完项目之后，在 front 文件夹中 执行 "),n("code",[s._v("npm run build")]),s._v(" 新建 dockerfile 创建 nginx 命令")]),s._v(" "),n("p",[s._v("front 项目应为是打包了 所以不用设置 dockerignore")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ./dist /usr/share/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ls -la /usr/share/nginx/html")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off;"')]),s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("然后执行打包命令 "),n("code",[s._v("docker build -t web:1.0 .")])]),s._v(" "),n("p",[s._v("在 server 文件夹中新建 dockerfile")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node:10")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /app")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yarn install --registry==http://registry.m.jd.com/")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 3000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),s._v(" ,"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/app.js"')]),s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("修改 dbconfig.js 文件中的链接 "),n("code",[s._v('mongodb://root:example@db:27017/admin"')]),s._v("\n打包 server "),n("code",[s._v("docker build -t server:1.0 .")])]),s._v(" "),n("p",[s._v("links: https://docs.docker.com/network/links/")]),s._v(" "),n("p",[s._v("在 front 和 server 外层编辑： docker-compose.yml\n打包命令： "),n("code",[s._v("docker-compose up -d")])]),s._v(" "),n("p",[s._v("然后访问 "),n("code",[s._v("http://localhost:8080/")]),s._v("即可；")]),s._v(" "),n("p",[s._v("最后如果想上传 docker 到自己的 "),n("code",[s._v("https://hub.docker.com/u/xiaozhumaopao")]),s._v("上")]),s._v(" "),n("p",[s._v("（1）在 front 文件夹下新建 dockerfile，执行")]),s._v(" "),n("ul",[n("li",[s._v("使用"),n("code",[s._v("docker build -t xiaozhumaopao/vueweb:1.0 .")]),s._v("打包；")]),s._v(" "),n("li",[s._v("使用"),n("code",[s._v("docker push xiaozhumaopao/vueweb:1.0")]),s._v("上传；")])]),s._v(" "),n("p",[s._v("（2）在 server 文件夹下新建 dockerfile，执行")]),s._v(" "),n("ul",[n("li",[s._v("使用"),n("code",[s._v("docker build -t xiaozhumaopao/koaweb:1.0 .")]),s._v("打包；")]),s._v(" "),n("li",[s._v("使用"),n("code",[s._v("docker push xiaozhumaopao/koaweb:1.0")]),s._v("上传；")])]),s._v(" "),n("p",[s._v("（3）在任意一个地方新建 docker-compose.yml 文件，执行"),n("code",[s._v("docker-compose up -d")]),s._v(",然后访问 "),n("code",[s._v("http://localhost:8080/")]),s._v("即可；")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" xiaozhumaopao/vueweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8080:80"')]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" xiaozhumaopao/koaweb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000:3000"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mongodb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("db\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mongodb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mongo\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"27017:27017"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MONGO_INITDB_ROOT_USERNAME")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MONGO_INITDB_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" example\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);